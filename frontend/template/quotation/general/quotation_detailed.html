{% extends "template/base.html" %}
{% import "element/button.html" as btn %}

{% block title %}ìƒì„¸ ê²¬ì ì„œ (ì„ì§€) - SYNEX+{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{{ url_for('static', path='/css/page/quotation/general/quotation_detailed.css') }}">
{% endblock %}

{% block extra_js %}
    <script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx.bundle.js"></script>
    <script src="{{ url_for('static', path='/js/page/quotation/general/quotation_detailed.js') }}"></script>
{% endblock %}

{% block content %}
<div class="quotation-cover-page">
    <div class="cover-shell">
        {# ì‚¬ì´ë“œ ì•¡ì…˜ë°” #}
        <div class="side-action-bar no-print" id="sideActionBar">
            <div class="action-group" id="viewActions">
                {{ btn.button("ìˆ˜ì •í•˜ê¸°", type="primary", onclick="toggleEditMode('edit')") }}
                {{ btn.button("Excel ì €ì¥", type="success", onclick="exportDetailedToExcel()") }}
                {{ btn.button("ì¸ì‡„í•˜ê¸°", type="default", onclick="window.print()") }}
                {{ btn.button("PDF ì €ì¥", type="default", onclick="exportToPDF()") }}
                {{ btn.button("ğŸ“„ ê°‘ì§€ ë§Œë“¤ê¸°", type="primary", onclick="openHeaderCreateModal()") }}
                {{ btn.button("ëª©ë¡ìœ¼ë¡œ", type="secondary", onclick="goBack()") }}
            </div>
            <div class="action-group" id="editActions" style="display: none;">
                {{ btn.blue_button("ì €ì¥í•˜ê¸°", id="saveBtn", onclick="saveDetailedData()") }}
                {{ btn.button("ì·¨ì†Œ", type="default", onclick="toggleEditMode('view')") }}
            </div>
        </div>

        <div class="cover-inner">
            <header>
                <h2 id="pageTitle" contenteditable="false" style="outline: none; cursor: text; padding: 8px; border-radius: 4px; transition: background 0.2s;">ìƒì„¸ ê²¬ì ì„œ (ì„ì§€)</h2>
                <div class="logo-placeholder">
                    <img src="/assets/images/Normal_Logo.png" alt="JLT Logo">
                </div>
            </header>
            
            <div id="loading" style="display: block; text-align: center; padding: 40px;">
                <p>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
            </div>
            
            <table id="detailedTable" class="editable-table" data-mode="view" style="display: none;">
                <thead>
                    <tr>
                        <th class="col-number">No</th>
                        <th style="width: 14%;">ì¥ë¹„ëª…</th>
                        <th>í’ˆëª…</th>
                        <th class="edit-qty">ìˆ˜ëŸ‰</th>
                        <th class="edit-unit">ë‹¨ìœ„</th>
                        <th class="edit-price">ë‹¨ê°€</th>
                        <th class="row-subtotal">ê³µê¸‰ê°€ì•¡</th>
                        <th>ë¹„ê³ </th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
                <tfoot>
                </tfoot>
            </table>

            <div class="quotation-note-container">
                <div class="note-header">
                    <h3>ë¹„ê³  (Note)</h3>
                </div>
                <div id="quotationDescription" class="description-box" contenteditable="false">
                </div>
            </div>
        </div>
    </div>

    <!-- ê°‘ì§€ ìƒì„± Modal -->
    <div id="headerCreateModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>ê°‘ì§€ ìƒì„±</h3>
                <button class="close-btn" onclick="closeHeaderCreateModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="headerCreateForm">
                    <div class="form-group">
                        <label for="headerTitle">ì œëª© <span style="color: red;">*</span></label>
                        <input type="text" id="headerTitle" class="form-control" required placeholder="ê°‘ì§€ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="form-group">
                        <label for="headerCreator">ì‘ì„±ì <span style="color: red;">*</span></label>
                        <input type="text" id="headerCreator" class="form-control" required placeholder="ì‘ì„±ìëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="form-group">
                        <label for="headerClient">ê³ ê°ì‚¬ <span style="color: red;">*</span></label>
                        <input type="text" id="headerClient" class="form-control" required placeholder="ê³ ê°ì‚¬ëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="form-group">
                        <label for="headerManufacturer">ì¥ë¹„ì‚¬</label>
                        <input type="text" id="headerManufacturer" class="form-control" placeholder="ì¥ë¹„ì‚¬ëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­)">
                    </div>
                    <div class="form-group">
                        <label for="headerPicName">ë‹´ë‹¹ìëª… <span style="color: red;">*</span></label>
                        <input type="text" id="headerPicName" class="form-control" required placeholder="ê³ ê°ì‚¬ ë‹´ë‹¹ìëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="form-group">
                        <label for="headerPicPosition">ë‹´ë‹¹ì ì§ê¸‰ <span style="color: red;">*</span></label>
                        <input type="text" id="headerPicPosition" class="form-control" required placeholder="ê³ ê°ì‚¬ ë‹´ë‹¹ì ì§ê¸‰ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeHeaderCreateModal()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="createHeaderFromModal()">ìƒì„±</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}