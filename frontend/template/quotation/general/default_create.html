{% extends "template/base.html" %}

{% block title %}견적서(일반) - SYNEX+{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{{ url_for('static', path='/css/page/quotation/general/default_create.css') }}">
{% endblock %}

{% block extra_js %}
    <script src="{{ url_for('static', path='/js/page/quotation/general/default_create.js') }}"></script>
{% endblock %}

{% block content %}
<div class="page-content">
    {# 상단 입력 정보 #}
    <div class="create-header">
        <h2 id="pageTitle">견적서(일반) 생성</h2>
        <div class="header-form">
            <div class="form-row">
                <div class="form-group">
                    <label for="generalName">견적서명 <span class="required">*</span></label>
                    <input type="text" id="generalName" class="form-input" placeholder="견적서명을 입력하세요" required>
                </div>
                <div class="form-group">
                    <label for="client">고객사</label>
                    <input type="text" id="client" class="form-input" placeholder="고객사를 입력하세요">
                </div>
                <div class="form-group">
                    <label for="creator">작성자 <span class="required">*</span></label>
                    <input type="text" id="creator" class="form-input" placeholder="작성자명을 입력하세요" required>
                </div>
                <div class="form-group">
                    <label for="manufacturer">장비사 <span class="required">*</span></label>
                    <input type="text" id="manufacturer" class="form-input" placeholder="장비사를 입력하세요" required>
                </div>
                <div class="form-group">
                    <label for="description">비고</label>
                    <input type="text" id="description" class="form-input" placeholder="비고를 입력하세요">
                </div>
            </div>
            <div class="form-row" id="viewOnlyFields" style="display: none;">
                <div class="form-group">
                    <label for="createdAt">생성일</label>
                    <input type="text" id="createdAt" class="form-input" value="-" readonly>
                </div>
                <div class="form-group">
                    <label for="updatedAt">수정일</label>
                    <input type="text" id="updatedAt" class="form-input" value="-" readonly>
                </div>
            </div>
        </div>
    </div>

    {# 1. 폴더 시스템 #}
    <div id="folderSection" style="display: none;">
        <hr class="divider">
        <div class="section-header" style="display: flex; justify-content: space-between; align-items: flex-end;">
            <div>
                <h3>폴더 및 견적서 관리</h3>
                <p class="section-description">폴더별로 내정가 비교서, 을지, 갑지를 관리합니다 (각 폴더당 최대 3개)</p>
            </div>
            <button class="btn btn-primary" onclick="openCreateFolderModal()" style="height: 36px;">+ 폴더 생성</button>
        </div>
        <div id="foldersContainer" class="folders-container"></div>
    </div>

    {# 2. 사용된 장비 견적서 목록 (신규 고도화 섹션) #}
    <div id="usedEquipmentSection" style="display: none;">
        <hr class="divider">
        <div class="section-header">
            <h3 style="color: #1e40af;">사용된 장비 견적서 목록</h3>
            <p class="section-description">내정가 견적 비교서 작성을 위해 참조된 실제 **장비 견적서** 리스트입니다.</p>
        </div>
        <div id="usedEquipmentTableContainer"></div>
    </div>

    {# 액션 버튼 #}
    <div class="action-footer">
        <div class="right-group">
            <button class="btn btn-secondary btn-lg" onclick="goToList()">목록으로</button>
            <button class="btn btn-warning btn-lg" onclick="toggleEditMode()" id="editBtn" style="display: none;">수정하기</button>
            <button class="btn btn-success btn-lg" onclick="submitGeneral()" id="submitBtn">등록완료</button>
            <button class="btn btn-secondary btn-lg" onclick="cancelEdit()" id="cancelBtn" style="display: none;">취소</button>
        </div>
    </div>
</div>

{# 폴더 생성 모달 #}
<div id="createFolderModal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>폴더 생성</h3>
            <button class="close-btn" onclick="closeFolderModal()">&times;</button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label for="folderTitle">폴더 제목 <span class="required">*</span></label>
                <input type="text" id="folderTitle" class="form-input" placeholder="폴더 제목을 입력하세요" required>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="closeFolderModal()">취소</button>
            <button class="btn btn-primary" onclick="submitCreateFolder()">생성</button>
        </div>
    </div>
</div>
{% endblock %}