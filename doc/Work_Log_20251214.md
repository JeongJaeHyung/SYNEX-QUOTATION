# Work Log - 2025-12-14

## 1. Machine Quotation (장비 견적서) 개선

### 1.1. 인건비(Labor Cost) 표시 로직 수정
*   **문제**: 템플릿 보기 모드에서도 모든 인건비 마스터 데이터가 표시되어 목록이 불필요하게 길어짐.
*   **해결**: `machine_create.html`의 `renderLaborItems` 및 `togglePartsView` 함수 수정.
    *   '템플릿 보기' 모드에서는 템플릿에 포함된 항목(`isTemplate`)이거나 사용자가 수량을 입력한 항목(`quantity > 0`)만 표시하도록 필터링 적용.
    *   '전체 보기' 모드에서는 기존대로 전체 마스터 항목 표시.

### 1.2. 'First Fill' 인건비 누락 수정
*   **문제**: `[TEMPLATE] 1st EL_1st Fill` 템플릿의 'First Fill' 인건비 항목이 화면에 나오지 않음.
*   **원인**: 엑셀 원본 데이터의 '모델명/규격' 컬럼이 "공백"이라는 텍스트로 되어 있어, 등록 스크립트가 이를 빈 문자열(`""`)로 처리함. 이로 인해 이름이 없는 부품이 생성되었고, 화면 렌더링 시 무시됨.
*   **해결**: 
    *   `tmp/register_templates.py` 스크립트 수정.
    *   부품 생성 시 `name`이 없으면 `minor`(품목) 값을 대체하여 저장하도록 로직 개선.
    *   기존에 잘못 저장된(이름 없음, 가격 0) 부품이 있다면 엑셀 데이터로 업데이트(`PUT`)하는 로직 추가.
    *   스크립트 재실행으로 DB 데이터 정상화 완료.

### 1.3. '케이블 및 기타 잡자재' 수동 입력 전환
*   **문제**: 자동 합계 항목으로 되어 있어 임의의 금액(예: 2,000만원)을 입력할 수 없음.
*   **해결**:
    *   HTML 행을 `input` 필드가 있는 수동 입력 행으로 변경 (`CABLE_ETC`).
    *   JS 로직(`manualSummaryItems`)에 `CABLE_ETC` 추가 및 자동 합계(`categoryOrder`)에서 제외.
    *   DB의 해당 부품 ID 매핑 및 저장/로드 로직 구현.

## 2. Parts List (부품 목록) UI/UX 개선

### 2.1. 무한 스크롤(Infinite Scroll) 도입
*   **기존**: 페이지네이션(이전/다음 버튼) 방식.
*   **변경**: `IntersectionObserver`를 활용한 무한 스크롤 방식으로 전면 교체.
    *   `scrollSentinel` 요소를 추가하여 스크롤 바닥 감지 시 자동 로딩.
    *   데이터 로딩 방식을 `replace`에서 `append`로 변경.
    *   한 번에 불러오는 개수(`limit`)를 30개로 조정.

### 2.2. 조회 모드 기능 개선
*   **변경**: 견적서 조회(Read-only) 모드에서도 부품 목록의 **검색** 및 **카테고리 필터** 사용이 가능하도록 입력창 활성화 (`disableAllInputs` 수정).
*   **필터**: 카테고리 필터 옵션을 하드코딩에서 **실제 데이터 기반 동적 생성**(`updateCategoryFilterOptions`)으로 변경.

### 2.3. UI 디테일 수정
*   인증 정보(UL, CE, KC)가 없을 때 'X' 대신 '-'로 표시하도록 `formatValue` 수정.
*   템플릿 보기 테이블에서 불필요한 '순서' 컬럼 제거.

## 3. 문서화 (Documentation)

### 3.1. 프로젝트 문서 생성
*   `GEMINI.md`: 프로젝트 개요, 기술 스택, 실행 방법, 폴더 구조 등을 한글로 정리.
*   `DATABASE.md`: 데이터베이스 ERD(Mermaid) 및 테이블별 상세 역할을 한글로 정리.
*   `database_erd_viewer.html`: 브라우저에서 ERD를 시각적으로 확인하고 SVG로 저장할 수 있는 뷰어 생성.

### 3.2. 문서 정리
*   `doc/` 폴더 생성 및 문서 파일 이동 예정.
